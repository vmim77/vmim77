11월 03일 수업

▶ 오전수업

[ 목록보기 - 내가 이전에 있던 페이지로 이동 ]

goBackURL을 사용한다. 전체목록보기와 다른 점은 1페이지가 아닌 내가 이전에 봤던(ex. 15페이지)로 돌아간다는 것이다.

만약 검색을 했다가 [목록보기] 버튼을 클릭하면, 그 검색된 목록만 있는 곳으로 돌아가야한다.


▶ # 123 
goBackURL을 글목록 메소드에서 생성해서 list.jsp에 전달을 해준다.
이후에 특정글을 클릭하면 특정글의 컨트롤러로 goBackURL을 전달해주고, 다시 view.jsp로 전달시켜줘야한다.

▶ # 124 
list.jsp 에서 글제목을 클릭하면 goView(seq) 함수가 실행된다. 여기서는 GET방식으로 seq만 전송하고 있는데, 여기에 goBackURL까지 같이 넘겨줘야 한다.

list.jsp에 새로운 폼태그를 만들어서 seq와 goBackURL을 다시 컨트롤러로 전달해준다.

▶ goView(seq) 함수도 기능을 변경을 해준다. 

이제 goViewFrm에 seq와 goBackURL을 input 태그에 쏴준다.

※ 또한 사용자가 선택한 검색타입과 입력한 검색어도 유지시켜줘야하니깐 goViewFrm에 추가를 해준다. (X)
==> gobackURL 자체에 이미 검색타입과 검색어가 있어서 필요가 없다.
==> 스크립트 단에서 문서가 로딩되면 컨트롤러에 전송된 값을 알아서 검색타입 select와 검색어 input에 넣어준다.

★ EL언어는 다음과 같이 주의해야한다.
==> EL언어로 값을 넣어줄때 숫자면 따옴표가 없어도 상관없지만 문자도 섞여있으면 값을 받는 변수에서 타입을 알 수 없으니깐 에러가 뜬다. 그래서 따옴표로 묶어줘야한다. 
==> 문자열이라고 인식을 시켜준다.
==> 숫자여도 호환이 다 되니깐 상관이 없다.
★ 항상 EL 방식의 값이 들어오는 곳에는 홑따옴표나 쌍따옴표를 써서 데이터타입 오류를 막는다.

▶ #125
goViewFrm --> BoardController - view.action --> view.jsp로 gobackURL을 전송한다.

▶ #126
검색된결과목록보기 버튼 클릭시 '<%= request.ContextPath()%>${requestScope.gobackURL}'로 이동을 시킨다.

=======================================================================

[댓글 페이징처리]

댓글이 많으면 쭉 이어지니, 5개씩 짤라서 페이징 처리를 한다.

■ view.jsp - goViewComment( ) - Ajax로 불러온 댓글내용을 페이징처리 하기

- 내가 지금 몇페이지의 댓글을 보고있는지를 알려줘야 한다.
- 그래서 goViewComment()에는 파라미터가 필요하다. (currentShowPageNo)


== 댓글내용 페이지바 Ajax로 만들기 ===

function makeCommentPageBar(currentShowPageNo) 생성

맨처음에는 currentShowPageNo가 1이여야하니, 문서가 로딩되면 goViewComment(1); 로 부른다.
- 가장 최신의 댓글은 내림차순 정렬이여서 맨 위에 있다.
- 그래서 내가 댓글을 쓴다면 goAddWrite_noAttach( ) 에서도 goViewComment(1); 로 부른다.

댓글 내용을 보여줌과 동시에 페이지바 함수도 호출해야한다. 
==> 늘어난 댓글 개수만큼 계산해서 페이지 버튼을 생성시켜줘야 해서

goViewComment( ) --> commentList.action --> 가져옴과 동시에 makeCommentPageBar() 호출해서 페이지바 생성 --> view.jsp


▶ #128 - commentList( )

※ 오늘 배우고나서 세미프로젝트 댓글기능에 추가해도 된다. ( Ajax로 페이징처리하기 )


▣ 페이징 공식

1. 조회할 게시글 범위

startRno = (currentShowPageNo-1) * sizePerPage +1
endRno = startRno + sizePerPage - 1

▶ #129. service 생성
▶ #130. DAO 생성	
▶ #131. board.xml 생성	


=== 댓글내용 페이지바 만들기 ===

원글의 seq를 알아야 댓글이 총 몇 개인지 알 수 있다.

Math.ceil(12/5) --> 3

▶ #132 ~ 135

댓글의 총 개수 알아오기
댓글의 총 페이지수 구하기(#132에서 이어짐) 
페이지바 찍기( view.jsp -- makeCommentPageBar() )
==> 어제는 java에서 찍어줬지만, 오늘은 javascript에서 찍어주는 것이 차이점이다.

★ 자바에서는 정수나누기 정수를 하면 무조건 정수가 나오지만, 자바스크립트에서는 소수부까지 나오기 때문에 pageNo를 구할 때 Math.floor를 이용하여 내림을 한 것이다.
==> 소수부가 있을시 Math.floor를 사용하면 값보다 작은 최대의 정수를 나타낸다.

★ 소수부가 없다면 Math.floor를 사용해도 그대로 나온다.
==> 소수부가 있다면 이제 그 값보다 작은 최대의 정수를 리턴시킴


★ 나누기를 할 때 자바와 자바스크립트는 다르다, 그래서 페이징 처리에서도 Math.floor를 쓴다는 점만 다르고 나머진 똑같다.


=======================================================================

=======================================================================

▶ 오후수업